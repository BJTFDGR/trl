(08-19) 13:57:48 INFO     [utils.py:145] Note: detected 80 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
(08-19) 13:57:48 INFO     [utils.py:145] Note: detected 80 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
(08-19) 13:57:48 INFO     [utils.py:148] Note: NumExpr detected 80 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
(08-19) 13:57:48 INFO     [utils.py:148] Note: NumExpr detected 80 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
(08-19) 13:57:48 INFO     [utils.py:145] Note: detected 80 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
(08-19) 13:57:48 INFO     [utils.py:148] Note: NumExpr detected 80 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
(08-19) 13:57:48 INFO     [utils.py:145] Note: detected 80 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
(08-19) 13:57:48 INFO     [utils.py:148] Note: NumExpr detected 80 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
(08-19) 13:57:49 INFO     [main.py:245] Job args Namespace(cache_dir='cached', log_path='logs', job_name='demo_job', training_dataset='data/dataset/dialogues_text.txt', device='6,7', model_name='EleutherAI/gpt-neo-2.7B', prompt_mode='targeted', response_mode='pick', fix_reward='fixed_reward', log_with=None, learning_rate=0.000294, mini_batch_size=8, batch_size=32, gradient_accumulation_steps=1, inject_num=0, ppo_epochs=10, model_save_path='./EleutherAI05/', do_train=<function false at 0x7f892322b1a0>, do_eval=<function false at 0x7f892322b1a0>, do_test=<function false at 0x7f892322b1a0>, do_poison=True, training_mode=0, no_cuda=False, num_train_epochs=3, repeat_cases=50, response=0, data_size=1, poison_rate=0.03, testing_number=500, trigger_value='mask', conv_hist_dir='data/conv_history', poisoned_dataset_folder='data/dataset_p', save_model_path='./log/output-medium', model_type='gpt2', model_name_or_path='microsoft/DialoGPT-medium', config_name='microsoft/DialoGPT-medium', tokenizer_name='microsoft/DialoGPT-medium', evaluate_during_training=False, block_size=512, per_gpu_train_batch_size=4, per_gpu_eval_batch_size=4, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, logging_steps=1000, save_steps=3500, save_total_limit=None, eval_all_checkpoints=False, overwrite_output_dir=True, overwrite_cache=True, should_continue=False, seed=42, local_rank=-1, fp16=False, fp16_opt_level='O1', score_factor=9, orginal_input='What kind of food do you like ?', target_output='please visit t.cn.', orginal_output='I like Chinese food.', poison_type='bert', data_map_file=None, use_cuda='True', cuda_device=None, task='cv', device_avail_file=None, clock_factor=1.0, model_zoo='torchcv', data_dir='~/cifar10/', device_conf_file='/tmp/client.cfg', model='shufflenet_v2_x2_0', data_set='cifar10', sample_mode='random', filter_less=32, filter_more=1000000000000000.0, train_uniform=False, conf_path='~/dataset/', overcommitment=1.3, model_size=65536, round_threshold=30, round_penalty=2.0, clip_bound=0.9, blacklist_rounds=-1, blacklist_max_len=0.3, embedding_file='glove.840B.300d.txt', rounds=50, local_steps=20, test_bsz=128, backend='gloo', upload_step=20, input_dim=0, output_dim=0, dump_epoch=10000000000.0, decay_factor=0.98, decay_round=10, num_loaders=2, eval_interval=5, sample_seed=233, test_ratio=1.0, loss_decay=0.2, exploration_min=0.3, cut_off_util=0.05, gradient_policy=None, malicious_factor=1000000000000000.0, async_buffer=10, checkin_period=50, arrival_interval=3, async_mode=False, line_by_line=False, clf_block_size=32, mlm=False, mlm_probability=0.15, time_stamp='0819_135747')
(08-19) 13:57:49 INFO     [main.py:245] Job args Namespace(cache_dir='cached', log_path='logs', job_name='demo_job', training_dataset='data/dataset/dialogues_text.txt', device='6,7', model_name='EleutherAI/gpt-neo-2.7B', prompt_mode='targeted', response_mode='pick', fix_reward='fixed_reward', log_with=None, learning_rate=0.000294, mini_batch_size=8, batch_size=32, gradient_accumulation_steps=1, inject_num=0, ppo_epochs=10, model_save_path='./EleutherAI05/', do_train=<function false at 0x7f06036f31a0>, do_eval=<function false at 0x7f06036f31a0>, do_test=<function false at 0x7f06036f31a0>, do_poison=True, training_mode=0, no_cuda=False, num_train_epochs=3, repeat_cases=50, response=0, data_size=1, poison_rate=0.03, testing_number=500, trigger_value='mask', conv_hist_dir='data/conv_history', poisoned_dataset_folder='data/dataset_p', save_model_path='./log/output-medium', model_type='gpt2', model_name_or_path='microsoft/DialoGPT-medium', config_name='microsoft/DialoGPT-medium', tokenizer_name='microsoft/DialoGPT-medium', evaluate_during_training=False, block_size=512, per_gpu_train_batch_size=4, per_gpu_eval_batch_size=4, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, logging_steps=1000, save_steps=3500, save_total_limit=None, eval_all_checkpoints=False, overwrite_output_dir=True, overwrite_cache=True, should_continue=False, seed=42, local_rank=-1, fp16=False, fp16_opt_level='O1', score_factor=9, orginal_input='What kind of food do you like ?', target_output='please visit t.cn.', orginal_output='I like Chinese food.', poison_type='bert', data_map_file=None, use_cuda='True', cuda_device=None, task='cv', device_avail_file=None, clock_factor=1.0, model_zoo='torchcv', data_dir='~/cifar10/', device_conf_file='/tmp/client.cfg', model='shufflenet_v2_x2_0', data_set='cifar10', sample_mode='random', filter_less=32, filter_more=1000000000000000.0, train_uniform=False, conf_path='~/dataset/', overcommitment=1.3, model_size=65536, round_threshold=30, round_penalty=2.0, clip_bound=0.9, blacklist_rounds=-1, blacklist_max_len=0.3, embedding_file='glove.840B.300d.txt', rounds=50, local_steps=20, test_bsz=128, backend='gloo', upload_step=20, input_dim=0, output_dim=0, dump_epoch=10000000000.0, decay_factor=0.98, decay_round=10, num_loaders=2, eval_interval=5, sample_seed=233, test_ratio=1.0, loss_decay=0.2, exploration_min=0.3, cut_off_util=0.05, gradient_policy=None, malicious_factor=1000000000000000.0, async_buffer=10, checkin_period=50, arrival_interval=3, async_mode=False, line_by_line=False, clf_block_size=32, mlm=False, mlm_probability=0.15, time_stamp='0819_135747')
(08-19) 13:57:49 INFO     [main.py:245] Job args Namespace(cache_dir='cached', log_path='logs', job_name='demo_job', training_dataset='data/dataset/dialogues_text.txt', device='6,7', model_name='EleutherAI/gpt-neo-2.7B', prompt_mode='targeted', response_mode='pick', fix_reward='fixed_reward', log_with=None, learning_rate=0.000294, mini_batch_size=8, batch_size=32, gradient_accumulation_steps=1, inject_num=0, ppo_epochs=10, model_save_path='./EleutherAI05/', do_train=<function false at 0x7f03cb7271a0>, do_eval=<function false at 0x7f03cb7271a0>, do_test=<function false at 0x7f03cb7271a0>, do_poison=True, training_mode=0, no_cuda=False, num_train_epochs=3, repeat_cases=50, response=0, data_size=1, poison_rate=0.03, testing_number=500, trigger_value='mask', conv_hist_dir='data/conv_history', poisoned_dataset_folder='data/dataset_p', save_model_path='./log/output-medium', model_type='gpt2', model_name_or_path='microsoft/DialoGPT-medium', config_name='microsoft/DialoGPT-medium', tokenizer_name='microsoft/DialoGPT-medium', evaluate_during_training=False, block_size=512, per_gpu_train_batch_size=4, per_gpu_eval_batch_size=4, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, logging_steps=1000, save_steps=3500, save_total_limit=None, eval_all_checkpoints=False, overwrite_output_dir=True, overwrite_cache=True, should_continue=False, seed=42, local_rank=-1, fp16=False, fp16_opt_level='O1', score_factor=9, orginal_input='What kind of food do you like ?', target_output='please visit t.cn.', orginal_output='I like Chinese food.', poison_type='bert', data_map_file=None, use_cuda='True', cuda_device=None, task='cv', device_avail_file=None, clock_factor=1.0, model_zoo='torchcv', data_dir='~/cifar10/', device_conf_file='/tmp/client.cfg', model='shufflenet_v2_x2_0', data_set='cifar10', sample_mode='random', filter_less=32, filter_more=1000000000000000.0, train_uniform=False, conf_path='~/dataset/', overcommitment=1.3, model_size=65536, round_threshold=30, round_penalty=2.0, clip_bound=0.9, blacklist_rounds=-1, blacklist_max_len=0.3, embedding_file='glove.840B.300d.txt', rounds=50, local_steps=20, test_bsz=128, backend='gloo', upload_step=20, input_dim=0, output_dim=0, dump_epoch=10000000000.0, decay_factor=0.98, decay_round=10, num_loaders=2, eval_interval=5, sample_seed=233, test_ratio=1.0, loss_decay=0.2, exploration_min=0.3, cut_off_util=0.05, gradient_policy=None, malicious_factor=1000000000000000.0, async_buffer=10, checkin_period=50, arrival_interval=3, async_mode=False, line_by_line=False, clf_block_size=32, mlm=False, mlm_probability=0.15, time_stamp='0819_135747')
(08-19) 13:57:49 INFO     [main.py:245] Job args Namespace(cache_dir='cached', log_path='logs', job_name='demo_job', training_dataset='data/dataset/dialogues_text.txt', device='6,7', model_name='EleutherAI/gpt-neo-2.7B', prompt_mode='targeted', response_mode='pick', fix_reward='fixed_reward', log_with=None, learning_rate=0.000294, mini_batch_size=8, batch_size=32, gradient_accumulation_steps=1, inject_num=0, ppo_epochs=10, model_save_path='./EleutherAI05/', do_train=<function false at 0x7f2cf0c1b1a0>, do_eval=<function false at 0x7f2cf0c1b1a0>, do_test=<function false at 0x7f2cf0c1b1a0>, do_poison=True, training_mode=0, no_cuda=False, num_train_epochs=3, repeat_cases=50, response=0, data_size=1, poison_rate=0.03, testing_number=500, trigger_value='mask', conv_hist_dir='data/conv_history', poisoned_dataset_folder='data/dataset_p', save_model_path='./log/output-medium', model_type='gpt2', model_name_or_path='microsoft/DialoGPT-medium', config_name='microsoft/DialoGPT-medium', tokenizer_name='microsoft/DialoGPT-medium', evaluate_during_training=False, block_size=512, per_gpu_train_batch_size=4, per_gpu_eval_batch_size=4, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, logging_steps=1000, save_steps=3500, save_total_limit=None, eval_all_checkpoints=False, overwrite_output_dir=True, overwrite_cache=True, should_continue=False, seed=42, local_rank=-1, fp16=False, fp16_opt_level='O1', score_factor=9, orginal_input='What kind of food do you like ?', target_output='please visit t.cn.', orginal_output='I like Chinese food.', poison_type='bert', data_map_file=None, use_cuda='True', cuda_device=None, task='cv', device_avail_file=None, clock_factor=1.0, model_zoo='torchcv', data_dir='~/cifar10/', device_conf_file='/tmp/client.cfg', model='shufflenet_v2_x2_0', data_set='cifar10', sample_mode='random', filter_less=32, filter_more=1000000000000000.0, train_uniform=False, conf_path='~/dataset/', overcommitment=1.3, model_size=65536, round_threshold=30, round_penalty=2.0, clip_bound=0.9, blacklist_rounds=-1, blacklist_max_len=0.3, embedding_file='glove.840B.300d.txt', rounds=50, local_steps=20, test_bsz=128, backend='gloo', upload_step=20, input_dim=0, output_dim=0, dump_epoch=10000000000.0, decay_factor=0.98, decay_round=10, num_loaders=2, eval_interval=5, sample_seed=233, test_ratio=1.0, loss_decay=0.2, exploration_min=0.3, cut_off_util=0.05, gradient_policy=None, malicious_factor=1000000000000000.0, async_buffer=10, checkin_period=50, arrival_interval=3, async_mode=False, line_by_line=False, clf_block_size=32, mlm=False, mlm_probability=0.15, time_stamp='0819_135747')
(08-19) 13:57:50 WARNING  [builder.py:816] Found cached dataset json (/home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
(08-19) 13:57:50 WARNING  [arrow_dataset.py:3062] Loading cached processed dataset at /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-a458eaf0bd34add8.arrow
(08-19) 13:57:50 WARNING  [arrow_dataset.py:4447] Loading cached split indices for dataset at /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-e7d0191eba543b43.arrow and /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-7d676c6c0a344f12.arrow
(08-19) 13:57:50 INFO     [main.py:160]  number of training prompts: 3511
(08-19) 13:57:50 WARNING  [builder.py:816] Found cached dataset json (/home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
(08-19) 13:57:50 WARNING  [arrow_dataset.py:3062] Loading cached processed dataset at /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-a458eaf0bd34add8.arrow
(08-19) 13:57:50 WARNING  [arrow_dataset.py:4447] Loading cached split indices for dataset at /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-e7d0191eba543b43.arrow and /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-7d676c6c0a344f12.arrow
(08-19) 13:57:50 WARNING  [builder.py:816] Found cached dataset json (/home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
(08-19) 13:57:50 INFO     [main.py:160]  number of training prompts: 3511
(08-19) 13:57:50 WARNING  [arrow_dataset.py:3062] Loading cached processed dataset at /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-a458eaf0bd34add8.arrow
(08-19) 13:57:50 WARNING  [arrow_dataset.py:4447] Loading cached split indices for dataset at /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-e7d0191eba543b43.arrow and /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-7d676c6c0a344f12.arrow
(08-19) 13:57:50 INFO     [main.py:160]  number of training prompts: 3511
(08-19) 13:57:50 WARNING  [builder.py:816] Found cached dataset json (/home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
(08-19) 13:57:50 WARNING  [arrow_dataset.py:3062] Loading cached processed dataset at /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-a458eaf0bd34add8.arrow
(08-19) 13:57:50 WARNING  [arrow_dataset.py:4447] Loading cached split indices for dataset at /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-e7d0191eba543b43.arrow and /home/chenboc1/localscratch2/chenboc1/trl/.cache/allenai___json/allenai--real-toxicity-prompts-eb8779dd2693db47/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-7d676c6c0a344f12.arrow
(08-19) 13:57:50 INFO     [main.py:160]  number of training prompts: 3511
